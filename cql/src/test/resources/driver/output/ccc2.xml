<Definitions>
  <Application id="filter">
    <Schemas>
      <Schema id="aiu_ho" name="aiu_ho">
        <attribute name="tdrid" type="java.lang.String"/>
        <attribute name="sysid" type="java.lang.Integer"/>
        <attribute name="orgcdrid" type="java.lang.String"/>
        <attribute name="abiscdrid" type="java.lang.String"/>
        <attribute name="acdrid" type="java.lang.String"/>
        <attribute name="horefid" type="java.lang.Long"/>
        <attribute name="zoneid" type="java.lang.Integer"/>
        <attribute name="poolid" type="java.lang.Integer"/>
        <attribute name="sccpid" type="java.lang.String"/>
        <attribute name="starttime" type="java.lang.Integer"/>
        <attribute name="millisec" type="java.lang.Integer"/>
        <attribute name="abis" type="java.lang.Integer"/>
        <attribute name="srvstat" type="java.lang.Integer"/>
        <attribute name="cdrstat" type="java.lang.Integer"/>
        <attribute name="ho_type" type="java.lang.Integer"/>
        <attribute name="inter_type" type="java.lang.Integer"/>
        <attribute name="ni" type="java.lang.Integer"/>
        <attribute name="opc" type="java.lang.Integer"/>
        <attribute name="dpc" type="java.lang.Integer"/>
        <attribute name="linktype" type="java.lang.Integer"/>
        <attribute name="access_type" type="java.lang.Integer"/>
        <attribute name="imsi" type="java.lang.String"/>
        <attribute name="tmsi" type="java.lang.String"/>
        <attribute name="msisdn" type="java.lang.String"/>
        <attribute name="imei" type="java.lang.String"/>
        <attribute name="mcc" type="java.lang.String"/>
        <attribute name="mnc" type="java.lang.String"/>
        <attribute name="orglac" type="java.lang.String"/>
        <attribute name="orgci" type="java.lang.String"/>
        <attribute name="tmnc" type="java.lang.String"/>
        <attribute name="targetlac" type="java.lang.String"/>
        <attribute name="targetci" type="java.lang.String"/>
        <attribute name="lastlac" type="java.lang.String"/>
        <attribute name="lastci" type="java.lang.String"/>
        <attribute name="orgrncid" type="java.lang.String"/>
        <attribute name="tarrncid" type="java.lang.String"/>
        <attribute name="horefnum" type="java.lang.Integer"/>
        <attribute name="codec" type="java.lang.Integer"/>
        <attribute name="ipaddr" type="java.lang.Long"/>
        <attribute name="port" type="java.lang.Integer"/>
        <attribute name="hold" type="java.lang.Integer"/>
        <attribute name="ho_cause" type="java.lang.Integer"/>
        <attribute name="firsttei" type="java.lang.Integer"/>
        <attribute name="firstchannel" type="java.lang.Integer"/>
        <attribute name="sumrxlevlul" type="java.lang.Long"/>
        <attribute name="sumrxlevldl" type="java.lang.Long"/>
        <attribute name="sumrxqualul" type="java.lang.Long"/>
        <attribute name="sumrxqualdl" type="java.lang.Long"/>
        <attribute name="sumbspwr" type="java.lang.Long"/>
        <attribute name="summspwr" type="java.lang.Long"/>
        <attribute name="sumta" type="java.lang.Long"/>
        <attribute name="totalmrno" type="java.lang.Integer"/>
        <attribute name="totalmrcount" type="java.lang.Integer"/>
        <attribute name="totalfullratemrno" type="java.lang.Integer"/>
        <attribute name="totalhalfratemrno" type="java.lang.Integer"/>
        <attribute name="sumrxquaul0" type="java.lang.Integer"/>
        <attribute name="sumrxquaul1" type="java.lang.Integer"/>
        <attribute name="sumrxquaul2" type="java.lang.Integer"/>
        <attribute name="sumrxquaul3" type="java.lang.Integer"/>
        <attribute name="sumrxquaul4" type="java.lang.Integer"/>
        <attribute name="sumrxquaul5" type="java.lang.Integer"/>
        <attribute name="sumrxquaul6" type="java.lang.Integer"/>
        <attribute name="sumrxquaul7" type="java.lang.Integer"/>
        <attribute name="sumrxquadl0" type="java.lang.Integer"/>
        <attribute name="sumrxquadl1" type="java.lang.Integer"/>
        <attribute name="sumrxquadl2" type="java.lang.Integer"/>
        <attribute name="sumrxquadl3" type="java.lang.Integer"/>
        <attribute name="sumrxquadl4" type="java.lang.Integer"/>
        <attribute name="sumrxquadl5" type="java.lang.Integer"/>
        <attribute name="sumrxquadl6" type="java.lang.Integer"/>
        <attribute name="sumrxquadl7" type="java.lang.Integer"/>
        <attribute name="ta01count" type="java.lang.Integer"/>
        <attribute name="rxlevel_down" type="java.lang.Integer"/>
        <attribute name="weak_coverage" type="java.lang.Integer"/>
        <attribute name="over_coverage" type="java.lang.Integer"/>
        <attribute name="imbalance" type="java.lang.Integer"/>
        <attribute name="interference" type="java.lang.Integer"/>
        <attribute name="ho_required_time" type="java.lang.Integer"/>
        <attribute name="ho_request_time" type="java.lang.Integer"/>
        <attribute name="ho_ack_time" type="java.lang.Integer"/>
        <attribute name="ho_cmd_time" type="java.lang.Integer"/>
        <attribute name="ho_detect_time" type="java.lang.Integer"/>
        <attribute name="ho_compt_time" type="java.lang.Integer"/>
        <attribute name="assn_time" type="java.lang.Integer"/>
        <attribute name="assn_cmpt_time" type="java.lang.Integer"/>
        <attribute name="alert_time" type="java.lang.Integer"/>
        <attribute name="answer_time" type="java.lang.Integer"/>
        <attribute name="direction" type="java.lang.Integer"/>
        <attribute name="hochartype" type="java.lang.Integer"/>
        <attribute name="ho_in_fail_time" type="java.lang.Integer"/>
        <attribute name="ho_out_fail_time" type="java.lang.Integer"/>
        <attribute name="ho_out_reject_time" type="java.lang.Integer"/>
        <attribute name="clear_req_time" type="java.lang.Integer"/>
        <attribute name="end_time" type="java.lang.Integer"/>
        <attribute name="pd" type="java.lang.Integer"/>
        <attribute name="firfailmsg" type="java.lang.Integer"/>
        <attribute name="cause" type="java.lang.Integer"/>
        <attribute name="encrypt_version" type="java.lang.Integer"/>
        <attribute name="reserved1" type="java.lang.String"/>
        <attribute name="reserved2" type="java.lang.String"/>
        <attribute name="reserved3" type="java.lang.String"/>
        <attribute name="reserved4" type="java.lang.Long"/>
        <attribute name="reserved5" type="java.lang.Integer"/>
        <attribute name="reserved6" type="java.lang.Integer"/>
        <attribute name="reserved7" type="java.lang.Integer"/>
        <attribute name="reserved8" type="java.lang.Integer"/>
        <attribute name="filelocation" type="java.lang.String"/>
        <attribute name="offset" type="java.lang.Integer"/>
        <attribute name="homemcc" type="java.lang.String"/>
        <attribute name="homemnc" type="java.lang.String"/>
        <attribute name="homeproid" type="java.lang.Integer"/>
        <attribute name="homeareaid" type="java.lang.Integer"/>
        <attribute name="probeid" type="java.lang.Integer"/>
        <attribute name="probeid2" type="java.lang.Integer"/>
        <attribute name="groupid" type="java.lang.Integer"/>
        <attribute name="lnkopc" type="java.lang.Integer"/>
        <attribute name="lnkdpc" type="java.lang.Integer"/>
        <attribute name="lnksrcip" type="java.lang.Long"/>
        <attribute name="lnksrcport" type="java.lang.Integer"/>
        <attribute name="lnkdestip" type="java.lang.Long"/>
        <attribute name="lnkdestport" type="java.lang.Integer"/>
        <attribute name="setup_time" type="java.lang.Integer"/>
        <attribute name="aiufirstxdrtype" type="java.lang.Integer"/>
        <attribute name="afirstxdrid" type="java.lang.String"/>
        <attribute name="mschotype" type="java.lang.Integer"/>
        <attribute name="hocallstate" type="java.lang.Integer"/>
        <attribute name="callsrvtype" type="java.lang.Integer"/>
        <attribute name="hointype" type="java.lang.Integer"/>
        <attribute name="initialmsc" type="java.lang.Integer"/>
        <attribute name="initialbsc" type="java.lang.Integer"/>
        <attribute name="initialmcc" type="java.lang.String"/>
        <attribute name="initialmnc" type="java.lang.String"/>
        <attribute name="initiallac" type="java.lang.String"/>
        <attribute name="initialci" type="java.lang.String"/>
        <attribute name="initialpoolid" type="java.lang.Integer"/>
        <attribute name="initialaccess_type" type="java.lang.Integer"/>
        <attribute name="hosourcemsc" type="java.lang.Integer"/>
        <attribute name="hosourceni" type="java.lang.Integer"/>
        <attribute name="hosourcepoolid" type="java.lang.Integer"/>
        <attribute name="hotargetmsc" type="java.lang.Integer"/>
        <attribute name="hotargetni" type="java.lang.Integer"/>
        <attribute name="hotargetpoolid" type="java.lang.Integer"/>
        <attribute name="callduration" type="java.lang.Integer"/>
        <attribute name="firfailtime" type="java.lang.Integer"/>
        <attribute name="layer1id" type="java.lang.Integer"/>
        <attribute name="layer2id" type="java.lang.Integer"/>
        <attribute name="layer3id" type="java.lang.Integer"/>
        <attribute name="layer4id" type="java.lang.Integer"/>
        <attribute name="layer5id" type="java.lang.Integer"/>
        <attribute name="layer6id" type="java.lang.Integer"/>
      </Schema>
      <Schema id="filter_ho" name="filter_ho">
        <attribute name="imsi" type="java.lang.String"/>
        <attribute name="eventid" type="java.lang.String"/>
        <attribute name="hocount" type="java.lang.Integer"/>
      </Schema>
      <Schema id="tmp" name="tmp">
        <attribute name="imsi" type="java.lang.String"/>
      </Schema>
      <Schema id="filter_ho_tmp" name="filter_ho_tmp">
        <attribute name="imsi" type="java.lang.String"/>
        <attribute name="eventid" type="java.lang.String"/>
        <attribute name="hocount" type="java.lang.Long"/>
      </Schema>
    </Schemas>
    <Operators>
      <TCPServerInput id="TCPServerInput_001" parallel="1">
        <deserializer class="BinarySerDe">
          <attributesLength>20,4,20,20,20,8,4,4,20,4,4,4,4,4,4,4,4,4,4,4,4,16,9,24,15,3,3,4,4,3,4,4,10,10,13,13,4,4,8,4,4,4,4,4,8,8,8,8,8,8,8,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,20,20,20,8,4,4,4,4,20,4,5,5,4,4,4,4,4,4,4,8,4,8,4,4,4,20,4,4,4,4,4,4,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4</attributesLength>
        </deserializer>
        <port>7999</port>
        <fixedLength>883</fixedLength>
      </TCPServerInput>
      <ConsoleOutput id="ConsoleOutput_002" parallel="1">
        <serializer class="SimpleSerDe"/>
        <printFrequence>1</printFrequence>
      </ConsoleOutput>
      <Functor id="Functor_005" parallel="1">
        <outputExpression>aiu_ho.imsi</outputExpression>
        <filterExpression>((aiu_ho.srvstat = 1) and  aiu_ho.cause in ( 0,1,2 ) )</filterExpression>
      </Functor>
      <Aggregator id="Aggregator_008" parallel="1">
        <outputExpression>tmp.imsi, &apos;Case1_Filter_HO&apos;,  count( tmp.imsi ) </outputExpression>
        <groupbyExpression>tmp.imsi</groupbyExpression>
        <window name="time_slide">
          <length>900000</length>
          <excludeNow>false</excludeNow>
        </window>
      </Aggregator>
      <Functor id="Functor_010" parallel="1">
        <outputExpression>filter_ho_tmp.imsi, filter_ho_tmp.eventid, filter_ho_tmp.hocount</outputExpression>
        <filterExpression>(filter_ho_tmp.hocount &gt; 20)</filterExpression>
      </Functor>
    </Operators>
    <Transitions>
      <Transition name="st_001" from="TCPServerInput_001" to="Functor_005" distributedType="SHUFFLE" schemaName="aiu_ho"/>
      <Transition name="st_002" from="Functor_005" to="Aggregator_008" distributedType="FIELDS" distributedFields="tmp.imsi" schemaName="tmp"/>
      <Transition name="st_003" from="Aggregator_008" to="Functor_010" distributedType="SHUFFLE" schemaName="filter_ho_tmp"/>
      <Transition name="st_009" from="Functor_010" to="ConsoleOutput_002" distributedType="SHUFFLE" schemaName="filter_ho"/>
    </Transitions>
  </Application>
</Definitions>